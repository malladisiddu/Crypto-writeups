

# This file was *autogenerated* from the file franklin_reiter.sage
from sage.all_cmdline import *   # import sage library

_sage_const_0 = Integer(0); _sage_const_10965843942173423395191922083359544443311758245798536249347473533217222061550517279502018991866595769868970245372949031525234619442919660318974944442517773209695284790451344906581914529925928832217233834503328753288319468161200048145636994940722941828989987811413501929960889016772962496729975216225912598552339984761010975114371008414930244352658425450814181044918265311210033114808020320651673798152287474513035536786837250120627982372426883086870501311877852462727781737629352104291719263595426084581941463019799892205153067071158484392128126160428849410023607481774960225963057886407847077004308786076736389294716 = Integer(10965843942173423395191922083359544443311758245798536249347473533217222061550517279502018991866595769868970245372949031525234619442919660318974944442517773209695284790451344906581914529925928832217233834503328753288319468161200048145636994940722941828989987811413501929960889016772962496729975216225912598552339984761010975114371008414930244352658425450814181044918265311210033114808020320651673798152287474513035536786837250120627982372426883086870501311877852462727781737629352104291719263595426084581941463019799892205153067071158484392128126160428849410023607481774960225963057886407847077004308786076736389294716); _sage_const_3013787012789618206105472620169845067567657921342135309829472626179050859602671452806031704465266891104347685483803872872374337883459890834885794379416480314812524300975360940908959637908700033163664079792186615580066627592842951598606022970141209671264656373358411192304368876239652915741600351684050242463106149673769705376069382704150875013104689474543841934498506591229918292876411898909905323968077028334563977723360191850875437591170072855021428535061442692016166692393928670559625128835690996124424675359741369416248492156452592276605590707391154203573061984419611094463464199005293698752521996521266226474427 = Integer(3013787012789618206105472620169845067567657921342135309829472626179050859602671452806031704465266891104347685483803872872374337883459890834885794379416480314812524300975360940908959637908700033163664079792186615580066627592842951598606022970141209671264656373358411192304368876239652915741600351684050242463106149673769705376069382704150875013104689474543841934498506591229918292876411898909905323968077028334563977723360191850875437591170072855021428535061442692016166692393928670559625128835690996124424675359741369416248492156452592276605590707391154203573061984419611094463464199005293698752521996521266226474427); _sage_const_19180711545893176513037550390323379574821852830665661812056678865741809891967598330424432450065638550340708416772232861627803383996685973692319978144111094705678356718069839745329804369923049623077146724976343425793942969144731442443607177966505595110345695314223998207352543996470777991272166737723490287258351016452097039979125039319504321174407700539531877444075872453220474913463319033875264101011295681676774076367210997858399851393634010112304767318681335454946488666538950765836709367621997962434256967765320251658524109362889423421160554230180542246491892887129152380892721807921025298941063392821275387956851 = Integer(19180711545893176513037550390323379574821852830665661812056678865741809891967598330424432450065638550340708416772232861627803383996685973692319978144111094705678356718069839745329804369923049623077146724976343425793942969144731442443607177966505595110345695314223998207352543996470777991272166737723490287258351016452097039979125039319504321174407700539531877444075872453220474913463319033875264101011295681676774076367210997858399851393634010112304767318681335454946488666538950765836709367621997962434256967765320251658524109362889423421160554230180542246491892887129152380892721807921025298941063392821275387956851); _sage_const_3 = Integer(3); _sage_const_2 = Integer(2)
from sage.all import *

# All the variable names mean the same as mentioned in the explanation
# For eg, a,b are the values in the function f = ax + b

def gcd(a, b): 
    while b:
        a, b = b, a % b
    return a.monic()

def franklinreiter(C1, C2, e, N):
    P = PolynomialRing(Zmod(N), names=('X',)); (X,) = P._first_ngens(1)
    g1 = (X + 124757617046649 )**e - C1
    g2 = (X + 107148233566056 )**e - C2
    print("Result")
    return -gcd(g1, g2).coefficients()[_sage_const_0 ]
c1 = _sage_const_10965843942173423395191922083359544443311758245798536249347473533217222061550517279502018991866595769868970245372949031525234619442919660318974944442517773209695284790451344906581914529925928832217233834503328753288319468161200048145636994940722941828989987811413501929960889016772962496729975216225912598552339984761010975114371008414930244352658425450814181044918265311210033114808020320651673798152287474513035536786837250120627982372426883086870501311877852462727781737629352104291719263595426084581941463019799892205153067071158484392128126160428849410023607481774960225963057886407847077004308786076736389294716 
c2 = _sage_const_3013787012789618206105472620169845067567657921342135309829472626179050859602671452806031704465266891104347685483803872872374337883459890834885794379416480314812524300975360940908959637908700033163664079792186615580066627592842951598606022970141209671264656373358411192304368876239652915741600351684050242463106149673769705376069382704150875013104689474543841934498506591229918292876411898909905323968077028334563977723360191850875437591170072855021428535061442692016166692393928670559625128835690996124424675359741369416248492156452592276605590707391154203573061984419611094463464199005293698752521996521266226474427 
n = _sage_const_19180711545893176513037550390323379574821852830665661812056678865741809891967598330424432450065638550340708416772232861627803383996685973692319978144111094705678356718069839745329804369923049623077146724976343425793942969144731442443607177966505595110345695314223998207352543996470777991272166737723490287258351016452097039979125039319504321174407700539531877444075872453220474913463319033875264101011295681676774076367210997858399851393634010112304767318681335454946488666538950765836709367621997962434256967765320251658524109362889423421160554230180542246491892887129152380892721807921025298941063392821275387956851 
e = _sage_const_3 

flag = franklinreiter(c1, c2, e, n)
print(flag)
print(bytes.fromhex(hex(int(flag))[_sage_const_2 :].replace("L","")).decode("ASCII"))

